<!DOCTYPE html>
<html ng-app="actApp">
<head lang="en">
    <meta charset="UTF-8">
    <title>ACampagneTest</title>
    <link rel="shortcut icon" href="assets/img/favicon.ico" type="image/x-icon">
    <link href='http://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="assets/bower_components/font-awesome/css/font-awesome.min.css">
    <link href="assets/dist/css/style.css" rel="stylesheet type=" text
    /css">
</head>
<body>

<div id="act" class="app" ng-controller="DashboardController">
    <section id="page-header" class="header page-header">
        <div class="hl">
            <div class="nav">
                <a href="" class="fa fa-navicon"></a>
            </div>
            <!-- <h1 class="title">A<span>Campagne</span>Test</h1> -->
        </div>
        <div class="hr">
            <nav class="nav">
                <ul class="clearfix">
                    <li class="alert"><a href="" class="fa fa-plus"></a></li>
                    <li class="alert"><a href="" class="fa fa-bell-o"></a></li>
                    <li class="user"><a href="">Alexandre Bury<i class="fa fa-angle-down"></i></a></li>
                </ul>
            </nav>
        </div>
    </section>

    <section id="page-container" class="page-container">
        <div class="campaign-list clearfix">
            <am-campaign ng-repeat="source in dashboard.sources" parameters="source"></am-campaign>
        </div>
    </section>
</div>

<div id="idx"></div>

<script src="assets/bower_components/angular/angular.min.js"></script>
<script src="assets/bower_components/d3/d3.min.js"></script>
<script src="assets/dist/js/script.js"></script>
<style>
    .chart {
        background-color: #eee;
    }

    .chart rect {

        fill: steelblue;

    }

    .axis {
        shape-rendering: crispEdges;
    }

    .x.axis line {
        stroke: black;
    }

    .y.axis line {
        stroke: black;
    }

    .axis text {
        font-size: 12px;
    }
</style>
<script>


    var json = [
        {
            "Year": "1",
            "Population": "20",
            "Annual growth rate (%)": "1.45",
            "Population change": "37,347,602"
        },
        {
            "Year": "2",
            "Population": "50",
            "Annual growth rate (%)": "1.6",
            "Population change": "41,871,643"
        },
        {
            "Year": "3",
            "Population": "10",
            "Annual growth rate (%)": "1.7",
            "Population change": "45,323,546"
        }
    ];

    var json = [
        {
            "standby": 200,
            "progress": 20,
            "ok": 30,
            "ko": 500
        }
    ];

    var results,
            data = [],
            chart,
            bars,
            margin = 100,
            w = 8,
            h = 70,
            x, y,
            xAxis, yAxis;

    results = d3.map(json);

    console.log(results);
    /*var json = json[0];

     for (key in json) {
     if (json.hasOwnProperty(key)) {
     color.push(Obj.color[key]);
     data.push(json[key]);
     obj[key] = json[key];
     length++;
     }
     }*/

    var max = 0,
            quotient = 0;
    results.forEach(function (key, val) {
        for (key in val) {
            if (val.hasOwnProperty(key)) {
                var result = {};
                result.status = key;
                result.val = val[key];
                data.push(result);
                max = Math.max(max, val[key])
            }
        }
    });

    quotient = max / h;
    console.log(quotient)

    chart = d3.select('#idx').append('svg')
            .attr('class', 'chart')
            .attr('width', 36)
            .attr('height', h)
            .append('g');

    d3.select('svg g')
            .attr('transform', 'translate(0, 100)');


    // Bars
    bars = chart.append('g')
            .attr('class', 'bars');

    bars.selectAll('rect')
            .data(data)
            .enter().append('rect')
            .attr('x', function (d, i) {
                return 9 * i;
            })
            .attr('y', function (d) {
                return (h - margin) - (d.val / quotient) + .5
            })
            .attr('width', w)
            .attr('height', function (d) {
                return ( d.val / quotient )
            })
            .append('g');

    // Axis
    /*xAxis = d3.svg.axis()
     .scale(x)
     .ticks(20)
     .tickSize(6, 3, 1);

     yAxis = d3.svg.axis()
     .scale(d3.scale.linear().domain( [0, d3.max( data, function( d ) { return d.population; } )] ).rangeRound( [h - margin, 0] ))
     .tickSize(6, 3, 1)
     .orient('right');*/

    


</script>
</body>
</html>